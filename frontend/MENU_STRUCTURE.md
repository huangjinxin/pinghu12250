# 侧边栏菜单结构说明

## 📋 新菜单结构概览

重构后的侧边栏采用 **7个一级菜单 + 折叠二级菜单** 的结构，提供清晰的导航层级和良好的用户体验。

## 🎯 学生端菜单结构（方案A：作品中心合并）

### 一级菜单（7个）

1. **首页** - 直接链接
2. **我的学习** - 可折叠（4个子菜单）
   - 日记
   - 作业
   - 读书
   - 学习追踪
3. **作品中心** - 可折叠（5个子菜单）⭐ 新调整
   - 作品广场（只显示预览，不可见源码）
   - 我的创作
   - 作品市集
   - 我的购买（查看和管理已购买的作品源码）
   - 我的商店
4. **游戏大厅** - 直接链接
5. **成长激励** - 可折叠（3个子菜单）
   - 每日挑战
   - 成就中心
   - 积分中心
6. **社交互动** - 可折叠（3个子菜单）
   - 好友
   - 动态
   - 标签广场
7. **工具箱** - 可折叠（3个子菜单）
   - 任务看板
   - 日历
   - 统计
8. **我的钱包** - 直接链接（显示余额徽章）
9. **个人中心** - 直接链接

## 💡 作品中心功能说明（方案A）

### 作品广场（/works）
- **功能定位**：公开展示平台，供用户预览和试玩作品
- **内容展示**：仅显示作品的运行效果预览
- **源码限制**：无法查看源代码，不能修改或Fork
- **购买跳转**：想要源码需跳转到"作品市集"购买（包括免费作品）

### 我的创作（/works/my）
- **功能定位**：管理自己创建的所有作品
- **分类筛选**：全部/公开/私有/草稿
- **操作权限**：查看、编辑、删除自己的作品
- **完整权限**：可查看和修改自己作品的完整源码

### 作品市集（/market）
- **功能定位**：作品交易平台
- **价格机制**：
  - 支持付费作品（金币购买）
  - 支持免费作品（0金币）
  - **重要**：免费作品也需要"购买"（0金币）才能查看源码
- **购买流程**：选择作品 → 确认购买 → 支付金币 → 获得源码访问权

### 我的购买（/my-purchases）⭐ 新增
- **功能定位**：管理已购买的作品源码
- **内容列表**：显示所有购买记录（含免费和付费）
- **源码访问**：
  - 查看完整HTML/CSS/JS源代码
  - 复制全部代码到剪贴板
  - 下载源码文件
  - Fork作品到自己账号
- **购买信息**：显示购买时间、价格、作者信息

### 我的商店（/my-shop）
- **功能定位**：管理自己上架的作品
- **销售统计**：上架数量、总销量、总收益
- **商品管理**：编辑定价、下架商品
- **销售记录**：查看销售明细

## 👨‍💼 角色专属菜单

### 管理员
在基础菜单前添加：
- **系统管理**（可折叠）
  - 用户管理
  - 校区管理
  - 班级管理
  - 游戏管理
  - 活动日志

### 老师
在基础菜单前添加：
- **我的班级**（直接链接）

### 家长
在基础菜单前添加：
- **我的孩子**（直接链接）

## 💡 交互特性

### 折叠/展开
- **手风琴模式**：点击带子菜单的项展开/收起
- **状态记忆**：展开状态保存在 localStorage
- **自动展开**：页面加载时自动展开包含当前路由的菜单项
- **动画效果**：平滑的展开/收起动画（300ms）

### 高亮规则
- **一级菜单**：包含当前路由时显示主色调文字
- **二级菜单**：当前路由显示主色调背景 + 文字
- **悬停效果**：所有菜单项悬停时显示浅灰色背景

### 图标动画
- 展开时箭头旋转 180°
- 过渡时间 200ms

## 📱 响应式设计

### PC端（≥1024px）
- 固定侧边栏，宽度 240px
- 显示完整菜单结构
- 金币余额显示在顶部导航栏

### 平板端（768px - 1023px）
- 抽屉式侧边栏（点击汉堡菜单打开）
- 带遮罩层
- 点击菜单项自动关闭侧边栏

### 移动端（<768px）
- 隐藏侧边栏
- 底部导航栏（5个固定项）
  - 学生：首页 / 学习 / 作品 / 社交 / 我的
  - 管理员：首页 / 管理 / 作品 / 社交 / 我的
  - 老师：首页 / 班级 / 作品 / 社交 / 我的
  - 家长：首页 / 孩子 / 作品 / 社交 / 我的

  > 注：移动端"作品"图标使用 EaselOutline（画架），点击后跳转到作品广场

## 🎨 样式规范

### 颜色
- 默认文字：`text-gray-600`
- 激活文字：`text-primary-600`
- 悬停背景：`bg-gray-50`
- 激活背景：`bg-primary-50`

### 间距
- 一级菜单：`px-3 py-2.5`
- 二级菜单：`pl-11 pr-3 py-2`（左侧缩进 44px）
- 菜单项间距：`space-y-1`

### 图标
- 一级菜单：20px
- 二级菜单：18px
- 展开箭头：16px

## 🔧 技术实现

### 数据结构
```javascript
{
  key: 'learning',           // 唯一标识
  label: '我的学习',         // 显示文本
  icon: LibraryOutline,      // 图标组件
  children: [                // 子菜单（可选）
    {
      key: 'diaries',
      path: '/diaries',
      icon: BookOutline,
      label: '日记'
    }
  ],
  badge: () => value         // 徽章函数（可选）
}
```

### 状态管理
- `expandedKeys`: 展开的菜单键数组
- 持久化到 `localStorage` 的 `menuExpandedKeys`

### 自动更新
- 钱包余额每 30 秒自动刷新
- 组件卸载时清理定时器

## 📝 使用示例

### 添加新菜单项
```javascript
// 在 baseMenuItems 中添加
{
  key: 'new-feature',
  path: '/new-feature',
  label: '新功能',
  icon: StarOutline
}
```

### 添加子菜单
```javascript
{
  key: 'parent-menu',
  label: '父菜单',
  icon: FolderOutline,
  children: [
    { key: 'child1', path: '/child1', icon: FileOutline, label: '子菜单1' },
    { key: 'child2', path: '/child2', icon: FileOutline, label: '子菜单2' }
  ]
}
```

### 添加徽章
```javascript
{
  key: 'notifications',
  path: '/notifications',
  label: '通知',
  icon: BellOutline,
  badge: () => unreadCount.value  // 返回数字或null
}
```

## ⚠️ 注意事项

1. 每个菜单项的 `key` 必须唯一
2. 带 `children` 的菜单项不能有 `path`
3. 子菜单项必须有 `path`
4. 图标必须从 `@vicons/ionicons5` 导入
5. 徽章函数返回 0 或空值时不显示徽章
